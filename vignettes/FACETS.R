### R code from vignette source 'FACETS.Rnw'
### Encoding: UTF-8

###################################################
### code chunk number 1: FACETS.Rnw:73-75
###################################################
datafile = system.file("extdata", "stomach.csv.gz", package="facets")
head(read.csv(datafile)[,c(1:2,5:12)])


###################################################
### code chunk number 2: FACETS.Rnw:88-89
###################################################
library(facets2n)


###################################################
### code chunk number 3: FACETS.Rnw:114-118
###################################################
set.seed(1234)
datafile = system.file("extdata", "stomach.csv.gz", package="facets")
rcmat = readSnpMatrix(datafile)
xx = preProcSample(rcmat)


###################################################
### code chunk number 4: FACETS.Rnw:130-131
###################################################
oo=procSample(xx,cval=150)


###################################################
### code chunk number 5: FACETS.Rnw:143-144
###################################################
oo$dipLogR


###################################################
### code chunk number 6: FACETS.Rnw:151-152
###################################################
fit=emcncf(oo)


###################################################
### code chunk number 7: FACETS.Rnw:181-182
###################################################
head(fit$cncf)


###################################################
### code chunk number 8: FACETS.Rnw:194-195
###################################################
fit$purity


###################################################
### code chunk number 9: FACETS.Rnw:198-199
###################################################
fit$ploidy


###################################################
### code chunk number 10: FACETS.Rnw:205-206
###################################################
plotSample(x=oo,emfit=fit)


###################################################
### code chunk number 11: FACETS.Rnw:219-220
###################################################
logRlogORspider(oo$out, oo$dipLogR)


###################################################
### code chunk number 12: FACETS.Rnw:247-248
###################################################
fit2=emcncf2(oo)


###################################################
### code chunk number 13: FACETS.Rnw:253-254
###################################################
head(fit2$cncf)


